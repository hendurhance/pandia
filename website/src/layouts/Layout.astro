---
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
  canonical?: string;
  image?: string;
  type?: 'website' | 'article';
  publishedTime?: string;
  modifiedTime?: string;
  noindex?: boolean;
}

const {
  title,
  description = 'Pandia is a free, open-source JSON visualization and editing tool for developers. Transform complex JSON data into interactive diagrams, generate types, compare documents, and moreâ€”all offline and privacy-first.',
  canonical,
  image = '/og-image.png',
  type = 'website',
  publishedTime,
  modifiedTime,
  noindex = false,
} = Astro.props;

const siteUrl = 'https://www.pandia.app';
const canonicalUrl = canonical ? `${siteUrl}${canonical}` : Astro.url.href;
const imageUrl = image.startsWith('http') ? image : `${siteUrl}${image}`;
const fullTitle = title === 'Pandia - Beautiful JSON Visualization Tool' ? title : `${title} | Pandia`;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>{fullTitle}</title>
    <meta name="title" content={fullTitle} />
    <meta name="description" content={description} />
    <meta name="keywords" content="JSON viewer, JSON editor, JSON visualization, JSON to TypeScript, JSON to Go, JSON diff, JSON compare, JSON repair, JSON query, JMESPath, developer tools, data visualization, API debugging, JSON formatter, JSON validator, open source, desktop app, Tauri, offline, privacy" />
    <meta name="author" content="hendurhance" />
    <meta name="robots" content={noindex ? 'noindex, nofollow' : 'index, follow'} />
    <link rel="canonical" href={canonicalUrl} />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content={type} />
    <meta property="og:url" content={canonicalUrl} />
    <meta property="og:title" content={fullTitle} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={imageUrl} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Pandia - JSON Visualization Tool" />
    <meta property="og:site_name" content="Pandia" />
    <meta property="og:locale" content="en_US" />
    {publishedTime && <meta property="article:published_time" content={publishedTime} />}
    {modifiedTime && <meta property="article:modified_time" content={modifiedTime} />}

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalUrl} />
    <meta name="twitter:title" content={fullTitle} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={imageUrl} />
    <meta name="twitter:image:alt" content="Pandia - JSON Visualization Tool" />
    <meta name="twitter:creator" content="@hendurhance" />

    <!-- Additional SEO -->
    <meta name="application-name" content="Pandia" />
    <meta name="apple-mobile-web-app-title" content="Pandia" />
    <meta name="theme-color" content="#FF6B35" />
    <meta name="msapplication-TileColor" content="#FF6B35" />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet" />

    <!-- Scroll to top on page load -->
    <script is:inline>
      if (history.scrollRestoration) {
        history.scrollRestoration = 'manual';
      }
      window.scrollTo(0, 0);
    </script>

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json" set:html={JSON.stringify({
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Pandia",
      "description": description,
      "url": siteUrl,
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "macOS, Windows, Linux",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "author": {
        "@type": "Person",
        "name": "hendurhance",
        "url": "https://github.com/hendurhance"
      },
      "license": "https://www.apache.org/licenses/LICENSE-2.0",
      "downloadUrl": "https://github.com/hendurhance/pandia/releases/latest",
      "softwareVersion": "0.1.0",
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "5",
        "ratingCount": "1"
      }
    })} />
  </head>
  <body class="bg-brand-darker text-brand-light font-sans antialiased">
    <slot />
  </body>
</html>
