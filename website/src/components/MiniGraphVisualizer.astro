---
/**
 * MiniGraphVisualizer - Premium animated SVG demo for the landing page
 * A polished, interactive-looking graph visualization
 */
---

<div class="mini-graph-container" id="graph-demo">
  <svg
    viewBox="0 0 800 420"
    class="mini-graph-svg"
    aria-label="Animated JSON graph visualization demo"
  >
    <defs>
      <!-- Gradient definitions -->
      <linearGradient id="bg-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" stop-color="#0a0a0c" />
        <stop offset="100%" stop-color="#12121a" />
      </linearGradient>

      <linearGradient id="node-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#1a1a24" />
        <stop offset="100%" stop-color="#141419" />
      </linearGradient>

      <linearGradient id="header-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#222230" />
        <stop offset="100%" stop-color="#1a1a24" />
      </linearGradient>

      <linearGradient id="connection-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
        <stop offset="0%" stop-color="#FF6A3A" stop-opacity="0.6" />
        <stop offset="50%" stop-color="#9C6BFF" stop-opacity="0.8" />
        <stop offset="100%" stop-color="#9C6BFF" stop-opacity="0.6" />
      </linearGradient>

      <linearGradient id="array-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#ec4899" />
        <stop offset="100%" stop-color="#be185d" />
      </linearGradient>

      <!-- Glow filters -->
      <filter id="node-shadow" x="-20%" y="-20%" width="140%" height="140%">
        <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000" flood-opacity="0.5" />
      </filter>

      <filter id="glow-orange" x="-50%" y="-50%" width="200%" height="200%">
        <feGaussianBlur stdDeviation="4" result="blur" />
        <feFlood flood-color="#FF6A3A" flood-opacity="0.6" />
        <feComposite in2="blur" operator="in" />
        <feMerge>
          <feMergeNode />
          <feMergeNode in="SourceGraphic" />
        </feMerge>
      </filter>

      <filter id="glow-purple" x="-50%" y="-50%" width="200%" height="200%">
        <feGaussianBlur stdDeviation="4" result="blur" />
        <feFlood flood-color="#9C6BFF" flood-opacity="0.6" />
        <feComposite in2="blur" operator="in" />
        <feMerge>
          <feMergeNode />
          <feMergeNode in="SourceGraphic" />
        </feMerge>
      </filter>

      <!-- Grid pattern -->
      <pattern id="grid-pattern" width="24" height="24" patternUnits="userSpaceOnUse">
        <path d="M 24 0 L 0 0 0 24" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1" />
      </pattern>

      <!-- Dot pattern -->
      <pattern id="dot-pattern" width="24" height="24" patternUnits="userSpaceOnUse">
        <circle cx="12" cy="12" r="1" fill="rgba(255,255,255,0.05)" />
      </pattern>

      <!-- Arrow markers -->
      <marker id="arrow" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto" markerUnits="userSpaceOnUse">
        <path d="M0,0 L12,4 L0,8 L3,4 Z" fill="url(#connection-gradient)" />
      </marker>

      <marker id="arrow-dim" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
        <path d="M0,0 L10,3.5 L0,7 L2,3.5 Z" fill="rgba(156,107,255,0.3)" />
      </marker>
    </defs>

    <!-- Background layers -->
    <rect width="100%" height="100%" fill="url(#bg-gradient)" />
    <rect width="100%" height="100%" fill="url(#grid-pattern)" />
    <rect width="100%" height="100%" fill="url(#dot-pattern)" class="dot-layer" />


    <!-- Connection paths -->
    <g class="connections">
      <!-- Root to API Response -->
      <path class="connection connection-1" d="M 218 190 C 280 190, 280 100, 340 100" />
      <!-- Root to Users Array -->
      <path class="connection connection-2" d="M 218 210 C 280 210, 280 235, 340 235" />
      <!-- Root to Meta -->
      <path class="connection connection-3" d="M 218 230 C 280 230, 280 355, 340 355" />
      <!-- API Response to Endpoint -->
      <path class="connection connection-4" d="M 508 100 C 560 100, 560 80, 600 80" />
      <!-- Users to User Item -->
      <path class="connection connection-5" d="M 508 235 C 560 235, 560 210, 600 210" />
    </g>

    <!-- Root Node: data -->
    <g class="node node-root" style="--delay: 0">
      <rect class="node-bg" x="50" y="130" width="168" height="140" rx="10" />
      <rect class="node-header" x="50" y="130" width="168" height="36" rx="10" />
      <rect x="50" y="156" width="168" height="10" fill="url(#header-gradient)" />

      <!-- Header content -->
      <circle cx="66" cy="148" r="4" fill="#FF6A3A" class="pulse-dot" />
      <text x="78" y="153" class="node-title">data</text>
      <text x="202" y="152" class="node-type" text-anchor="end">Object</text>

      <!-- Rows -->
      <g class="node-rows">
        <text x="62" y="186" class="row-key">status</text>
        <text x="206" y="186" class="row-value string" text-anchor="end">"success"</text>

        <rect x="51" y="194" width="166" height="24" fill="rgba(255,255,255,0.02)" rx="2" />
        <text x="62" y="212" class="row-key">count</text>
        <text x="206" y="212" class="row-value number" text-anchor="end">2,847</text>

        <text x="62" y="238" class="row-key">cached</text>
        <text x="206" y="238" class="row-value boolean" text-anchor="end">true</text>

        <rect x="51" y="244" width="166" height="22" fill="rgba(255,255,255,0.02)" rx="2" />
        <text x="62" y="260" class="row-key clickable">response</text>
        <text x="206" y="260" class="row-value object" text-anchor="end">Object →</text>
      </g>
    </g>

    <!-- Node: response -->
    <g class="node node-response" style="--delay: 1">
      <rect class="node-bg" x="340" y="50" width="168" height="100" rx="10" />
      <rect class="node-header" x="340" y="50" width="168" height="36" rx="10" />
      <rect x="340" y="76" width="168" height="10" fill="url(#header-gradient)" />

      <circle cx="356" cy="68" r="4" fill="#9C6BFF" class="pulse-dot" />
      <text x="368" y="73" class="node-title">response</text>
      <text x="492" y="72" class="node-type" text-anchor="end">Object</text>

      <g class="node-rows">
        <text x="352" y="106" class="row-key">version</text>
        <text x="496" y="106" class="row-value string" text-anchor="end">"2.1.0"</text>

        <rect x="341" y="114" width="166" height="24" fill="rgba(255,255,255,0.02)" rx="2" />
        <text x="352" y="132" class="row-key clickable">endpoint</text>
        <text x="496" y="132" class="row-value object" text-anchor="end">Object →</text>
      </g>
    </g>

    <!-- Node: users (array) -->
    <g class="node node-array" style="--delay: 2">
      <rect class="node-bg" x="340" y="170" width="168" height="130" rx="10" />
      <rect class="node-header" x="340" y="170" width="168" height="36" rx="10" />
      <rect x="340" y="196" width="168" height="10" fill="url(#header-gradient)" />

      <!-- Array indicator bar -->
      <rect x="340" y="170" width="4" height="130" rx="2" fill="url(#array-gradient)" />

      <circle cx="360" cy="188" r="4" fill="#ec4899" class="pulse-dot" />
      <text x="372" y="193" class="node-title">users</text>
      <text x="492" y="192" class="node-type array" text-anchor="end">Array[42]</text>

      <g class="node-rows">
        <text x="352" y="226" class="row-key array-index">[0]</text>
        <text x="496" y="226" class="row-value object" text-anchor="end">User →</text>

        <rect x="341" y="234" width="166" height="24" fill="rgba(255,255,255,0.02)" rx="2" />
        <text x="352" y="252" class="row-key array-index">[1]</text>
        <text x="496" y="252" class="row-value object" text-anchor="end">User</text>

        <text x="352" y="278" class="row-key array-index">[2]</text>
        <text x="496" y="278" class="row-value object" text-anchor="end">User</text>
      </g>
    </g>

    <!-- Node: meta -->
    <g class="node node-meta" style="--delay: 3">
      <rect class="node-bg" x="340" y="320" width="168" height="88" rx="10" />
      <rect class="node-header" x="340" y="320" width="168" height="36" rx="10" />
      <rect x="340" y="346" width="168" height="10" fill="url(#header-gradient)" />

      <circle cx="356" cy="338" r="4" fill="#FF6A3A" class="pulse-dot" />
      <text x="368" y="343" class="node-title">meta</text>
      <text x="492" y="342" class="node-type" text-anchor="end">Object</text>

      <g class="node-rows">
        <text x="352" y="376" class="row-key">timestamp</text>
        <text x="496" y="376" class="row-value number" text-anchor="end">1706198400</text>

        <rect x="341" y="382" width="166" height="22" fill="rgba(255,255,255,0.02)" rx="2" />
        <text x="352" y="398" class="row-key">region</text>
        <text x="496" y="398" class="row-value string" text-anchor="end">"us-west-2"</text>
      </g>
    </g>

    <!-- Node: endpoint (smaller) -->
    <g class="node node-endpoint" style="--delay: 4">
      <rect class="node-bg" x="600" y="40" width="150" height="80" rx="10" />
      <rect class="node-header" x="600" y="40" width="150" height="32" rx="10" />
      <rect x="600" y="64" width="150" height="8" fill="url(#header-gradient)" />

      <text x="612" y="61" class="node-title small">endpoint</text>
      <text x="738" y="60" class="node-type small" text-anchor="end">Object</text>

      <g class="node-rows">
        <text x="612" y="90" class="row-key small">path</text>
        <text x="738" y="90" class="row-value string small" text-anchor="end">"/api/v2"</text>

        <text x="612" y="110" class="row-key small">method</text>
        <text x="738" y="110" class="row-value string small" text-anchor="end">"GET"</text>
      </g>
    </g>

    <!-- Node: user item -->
    <g class="node node-user" style="--delay: 5">
      <rect class="node-bg selected" x="600" y="155" width="150" height="110" rx="10" />
      <rect class="node-header" x="600" y="155" width="150" height="32" rx="10" />
      <rect x="600" y="179" width="150" height="8" fill="url(#header-gradient)" />

      <text x="612" y="176" class="node-title small">users[0]</text>
      <text x="738" y="175" class="node-type small" text-anchor="end">Object</text>

      <g class="node-rows">
        <text x="612" y="205" class="row-key small">id</text>
        <text x="738" y="205" class="row-value number small" text-anchor="end">1847</text>

        <rect x="601" y="210" width="148" height="20" fill="rgba(255,255,255,0.02)" rx="2" />
        <text x="612" y="225" class="row-key small">name</text>
        <text x="738" y="225" class="row-value string small" text-anchor="end">"Alex Chen"</text>

        <text x="612" y="245" class="row-key small">active</text>
        <text x="738" y="245" class="row-value boolean small" text-anchor="end">true</text>

        <rect x="601" y="250" width="148" height="12" fill="rgba(255,255,255,0.02)" rx="2" />
      </g>

      <!-- Selection indicator -->
      <rect class="selection-ring" x="597" y="152" width="156" height="116" rx="12" />
    </g>

    <!-- Cursor indicator on selected node -->
    <g class="cursor-indicator">
      <circle cx="675" cy="210" r="8" fill="rgba(156,107,255,0.2)" class="cursor-ring" />
      <circle cx="675" cy="210" r="3" fill="#9C6BFF" />
    </g>

    <!-- Bottom info bar -->
    <g class="info-bar">
      <rect x="585" y="383" width="180" height="32" rx="8" fill="rgba(20,20,25,0.9)" stroke="rgba(255,255,255,0.06)" />
      <text x="675" y="403" class="info-text" text-anchor="middle">
        <tspan fill="#7d8590">Drag to pan</tspan>
        <tspan fill="#48484A" dx="6">•</tspan>
        <tspan fill="#7d8590" dx="6">Scroll to zoom</tspan>
      </text>
    </g>
  </svg>

</div>

<style>
  .mini-graph-container {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  .mini-graph-svg {
    display: block;
    width: 100%;
    height: auto;
  }

  /* Dot layer animation */
  .dot-layer {
    animation: dot-drift 20s linear infinite;
  }

  @keyframes dot-drift {
    0% { transform: translate(0, 0); }
    100% { transform: translate(24px, 24px); }
  }

  /* Connection styling */
  .connection {
    fill: none;
    stroke: url(#connection-gradient);
    stroke-width: 2.5;
    stroke-linecap: round;
    marker-end: url(#arrow);
    stroke-dasharray: 300;
    stroke-dashoffset: 300;
  }

  .connection-1 { animation: draw-connection 0.8s ease-out 0.3s forwards; }
  .connection-2 { animation: draw-connection 0.8s ease-out 0.5s forwards; }
  .connection-3 { animation: draw-connection 0.8s ease-out 0.7s forwards; }
  .connection-4 { animation: draw-connection 0.6s ease-out 1.2s forwards; }
  .connection-5 { animation: draw-connection 0.6s ease-out 1.4s forwards; }

  @keyframes draw-connection {
    to { stroke-dashoffset: 0; }
  }

  /* Node styling */
  .node {
    opacity: 0;
    animation: node-enter 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    animation-delay: calc(var(--delay) * 0.15s + 0.1s);
  }

  @keyframes node-enter {
    0% {
      opacity: 0;
      transform: translateY(20px) scale(0.95);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .node-bg {
    fill: url(#node-gradient);
    stroke: rgba(255, 255, 255, 0.08);
    stroke-width: 1;
    filter: url(#node-shadow);
    transition: stroke 0.3s ease;
  }

  .node:hover .node-bg {
    stroke: rgba(156, 107, 255, 0.4);
  }

  .node-bg.selected {
    stroke: rgba(156, 107, 255, 0.6);
  }

  .node-header {
    fill: url(#header-gradient);
  }

  .node-title {
    font-family: 'Inter', system-ui, sans-serif;
    font-size: 13px;
    font-weight: 600;
    fill: #f0f6fc;
  }

  .node-title.small {
    font-size: 11px;
  }

  .node-type {
    font-family: 'Inter', system-ui, sans-serif;
    font-size: 10px;
    font-weight: 500;
    fill: #6b7280;
  }

  .node-type.small {
    font-size: 9px;
  }

  .node-type.array {
    fill: #ec4899;
  }

  .row-key {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
    fill: #6b7280;
  }

  .row-key.small {
    font-size: 10px;
  }

  .row-key.array-index {
    fill: #ec4899;
  }

  .row-key.clickable {
    fill: #9C6BFF;
  }

  .row-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 11px;
  }

  .row-value.small {
    font-size: 10px;
  }

  .row-value.string { fill: #5eead4; }
  .row-value.number { fill: #60a5fa; }
  .row-value.boolean { fill: #fbbf24; }
  .row-value.object { fill: #a78bfa; }

  /* Pulse dot animation */
  .pulse-dot {
    animation: pulse-dot 2s ease-in-out infinite;
  }

  @keyframes pulse-dot {
    0%, 100% { opacity: 1; r: 4; }
    50% { opacity: 0.6; r: 3; }
  }

  /* Selection ring */
  .selection-ring {
    fill: none;
    stroke: #9C6BFF;
    stroke-width: 2;
    stroke-dasharray: 6 4;
    animation: dash-rotate 20s linear infinite, ring-pulse 2s ease-in-out infinite;
  }

  @keyframes dash-rotate {
    to { stroke-dashoffset: -100; }
  }

  @keyframes ring-pulse {
    0%, 100% { opacity: 0.8; }
    50% { opacity: 0.4; }
  }

  /* Cursor indicator */
  .cursor-indicator {
    animation: cursor-fade 0.5s ease-out 1.8s forwards;
    opacity: 0;
  }

  @keyframes cursor-fade {
    to { opacity: 1; }
  }

  .cursor-ring {
    animation: cursor-ring-pulse 1.5s ease-in-out infinite;
  }

  @keyframes cursor-ring-pulse {
    0%, 100% { r: 8; opacity: 0.2; }
    50% { r: 12; opacity: 0.1; }
  }

  /* Info bar */
  .info-bar {
    animation: info-fade 0.5s ease-out 2s forwards;
    opacity: 0;
  }

  @keyframes info-fade {
    to { opacity: 1; }
  }

  .info-text {
    font-family: 'JetBrains Mono', monospace;
    font-size: 9px;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .info-bar {
      display: none;
    }
  }
</style>
